<app-navbar></app-navbar>

<main class="containerNew app-main pl-5 pr-5">
  <section class="">
    <section class="header">
      <article class="row">
        <button class="btn btn-link text-secondary" style="padding-left: 0px;" routerLink="/home"
          title="Regresar a la Pantalla Principal">
          <span class="fas fa-chevron-left"></span> Pantalla Principal
        </button>
      </article>
      <article>
        <div class="row" style="display: flex;justify-content: flex-start;align-items: center;">
          <div class="col-lg-30">
            <h4 class="TitleLine">Búsqueda de Coincidencias a Demanda</h4>
          </div>
        </div>
      </article>
    </section>
    <!-- prueba responsive -->
    <div class="container-fluid pl-4 pr-4  row" style="padding-top: 0px;padding-bottom: 20px;">
      <div class="card-body" style="padding-left: 0; padding-right:0;padding-top: 0px;padding-bottom: 20px;">
        <div id="laft" class="mb-2 mt-2 tab-pane " style="padding-left: 0; padding-right: 0;">
          <article class="row  form-group">
            <div class="col-lg-11 col-sm-12" style="padding-right: 0px;padding-left: 30px;">
              <div class="row">
                <div class="col-xl-2 col-lg-6 d-flex py-1">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12" style="padding:0">
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <label class="fontText">Tipo de Búsqueda:</label>
                    </div>
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <select class="form-control buttonSinBorder colorButton " (change)="searchTypeChange($event)"
                        [(ngModel)]="NBUSCAR_POR">
                        <option value="1">Individual</option>
                        <option value="2">Masiva</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div [hidden]="hideIndividual" class="col-xl-2 col-lg-6 d-flex py-1">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12" style="padding:0">
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <label class="fontText">Tipo de Documento:</label>
                    </div>
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <select id="tipoDoc" class="form-control buttonSinBorder colorButton"  [(ngModel)]="NOMBRE_RAZON" >
                        <option value="0" title="Seleccione">Seleccione</option>
                        <option value="2" title="DNI">DNI</option>
                        <option value="1" title="RUC">RUC</option>
                        <option value="3" title="CE">CE</option>
                        <option value="4" title="PASS">PASS</option>
                      </select>
                    </div>
                  </div>
                </div>
                <div [hidden]="hideIndividual" class="col-xl-3 col-lg-6 d-flex py-1">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12" style="padding:0">
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <label class="fontText">Número de Documento:</label>
                    </div>
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <input id="doc" type="text" class="form-control buttonSinBorder colorButton"
                        maxlength="{{validationCantidadCaracteres()}}" size="20" (keypress)="validaNumericos($event)"
                        [(ngModel)]="numeroDoc" placeholder="Número de Documento">
                    </div>
                  </div>
                </div>
                <div [hidden]="hideIndividual" class="col-xl-4 col-lg-6 d-flex py-1">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12" style="padding:0">
                    <div class="col-xs-12 col-sm-12" style="padding:0">
                      <label class="fontText">Nombre Completo:</label>
                    </div>
                    <div class="col-xs-12 col-sm-12" style="display:flex; padding: 0">
                      <input type="text" class="form-control buttonSinBorder colorButton" maxlength="100" size="30"
                        [(ngModel)]="nombreCompleto" (keypress)="soloLetras($event)"
                        pattern="[a-zA-Z\u00f1\u00d1]+ [a-zA-Z\u00f1\u00d1]+ [a-zA-Z\u00f1\u00d1]+"
                        placeholder="Nombre Completo">
                      <div type="button" data-toggle="tooltip" data-placement="top"
                        title="[Apellido1] [Apellido2] [Nombre]">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor"
                          class="bi bi-info" viewBox="0 0 16 16" style="border: 1px solid #A6A6A6; border-radius: 50px">
                          <path
                            d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z" />
                        </svg>
                      </div>
                    </div>
                  </div>
                </div>
                <div [hidden]="hideIndividual" *ngIf="mostrarBotonBuscarIndividual()"
                  class="col-lg-1  py-1 positionbutton" style="align-self: flex-end;padding-left: 0;">
                  <button _ngcontent-qgx-c1="" id="enter" class="btn btn-warning text-white px-4 btnBuscarStyle"
                    (click)="validarNulos()">
                    Buscar
                  </button>
                </div>
                <div [hidden]="hideMasiva" class="col-xl-4 col-lg-6 d-flex py-1 col-lg-1 ">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12 "
                    style="align-items: self-end; padding: 0;">
                    <div class="custom-file col-xs-12 col-sm-12" style="padding: 0;">
                      <input #myInput type="file" class="custom-file-input" id="customFile" name="filename"
                        accept=".xlsx" onclick="this.value=null;" value="seleccionar" (change)="setDataFile($event)"
                        [(ngModel)]="archivoExcel">
                      <label class="custom-file-label" for="customFile"
                        style="background-color:#e9ecef">{{this.NombreArchivo == '' ? "Adjuntar Archivo" : this.NombreArchivo }}</label>
                    </div>
                  </div>
                </div>
                <div [hidden]="hideMasiva" class="col-xl-4 col-lg-6 d-flex py-1 col-lg-1 "
                  style="align-items: self-end">
                  <div class="row col-2 col-sm-4 col-md-6 col-lg-8 col-xl-12" style="padding:0">
                    <div *ngIf="mostrarBotonBuscarMasiva()" class="col-xs-12 col-sm-12"
                      style="align-items: center; padding:0">
                      <button (click)="DescargarPlantilla()"
                        class="btn btn-outline-info form-control mr-2 buttonSinBorder colorButton"><i
                          class="fas fa-download"></i> Descargar Plantilla </button>
                    </div>
                  </div>
                </div>
                <div [hidden]="hideMasiva" *ngIf="mostrarBotonBuscarMasiva()" class="col-lg-1  py-1 positionbutton"
                  style="align-self: flex-end;padding-left: 0;">
                  <button _ngcontent-qgx-c1="" id="enter" class="btn btn-warning text-white px-4 btnBuscarStyle"
                    (click)="BusquedaADemandaMixta()">
                    <!-- "validarNulos()" -->
                    Buscar
                  </button>
                </div>
              </div>
            </div>
          </article>
            <div class="" style="overflow-y:none;">
              <!-- overflow-y:none; -->
              <hr>
              <div class="table-responsive">
                <table class="striped table-striped table-sm" style="font-size: 12px;">
                  <thead>
                    <tr>
                      <th class="columnGroup1" colspan="5">Datos de la Búsqueda</th>
                      <th class="columnGroup2" colspan="2">Persona que se busca</th>
                      <th class="columnGroup3" colspan="5">Coincidencia Encontrada</th>
                      <th class="columnGroup4" colspan="5"></th>
                    </tr>
                    <tr style="color: rgba(38, 41, 109, 0.6);font-family: 'Roboto', sans-serif; ">
                      <th class="columnGroup1" style="vertical-align: middle;">Fecha y Hora de Búsqueda</th>
                      <th class="columnGroup1" style="vertical-align: middle;">Usuario que Realizó la Búsqueda</th>
                      <th class="columnGroup1" style="vertical-align: middle;text-align: left;">Lista</th>
                      <th class="columnGroup1" style="vertical-align: middle;text-align: left;">Fuente</th>
                      <th class="columnGroup1" style="vertical-align: middle;">Búsqueda</th>
                      <th class="columnGroup2" style="vertical-align: middle;">Tipo y Número de Documento</th>
                      <th class="columnGroup2" style="vertical-align: middle;"> Nombre/Razón Social</th>
                      <th class="columnGroup3" style="vertical-align: middle;">Tipo y Número de Documento</th>
                      <th class="columnGroup3" style="vertical-align: middle;">Término</th>
                      <th class="columnGroup3" style="vertical-align: middle;text-align: left;">Nombre/Razón Social</th>
                      <th class="columnGroup3" style="vertical-align: middle;">% Coincidencia</th>
                      <th class="columnGroup3" style="vertical-align: middle;">Tipo de Coincidencia</th>
                      <th class="columnGroup4" style="vertical-align: middle;">Descargar</th>
                    </tr>
                  </thead>
                  <tbody [hidden]="false">
                    <tr class="animated fadeIn" *ngFor="let item of resultadoFinalAgregado; let i = index;">
                      <td>{{item.dfechA_BUSQUEDA}}</td>
                      <td>{{item.SUSUARIO_BUSQUEDA != '' ? item.SUSUARIO_BUSQUEDA : '-'}} </td>
                      <td>{{item.sdestipolista}}</td>
                      <td>{{item.sdesproveedor}}</td>
                      <td>{{item.scoincidencia}}</td>
                      <td>{{item.snumdoC_BUSQUEDA == null || item.snumdoC_BUSQUEDA == '' ? '-': item.snumdoC_BUSQUEDA}}
                      </td>
                      <td>{{item.snombrE_BUSQUEDA}}</td>
                      <td>{{item.stipO_DOCUMENTO}} {{item.snuM_DOCUMENTO}}</td>
                      <td>
                        <div placement='top' ngbTooltip="{{item.snombrE_TERMINO}}" *ngIf="item.SPROVEEDOR == 'WC'">
                          {{cortarCararterNombre(item.snombrE_TERMINO)}}</div>
                      </td>
                      <td>
                        <div placement='top' ngbTooltip="{{item.SNOMBRE_COMPLETO}}">
                          {{cortarCararterNombre(item.snombrE_COMPLETO)}}</div>
                      </td>
                      <td style="text-align: center;">{{item.sporceN_COINCIDENCIA}}</td>
                      <td>{{item.stipocoincidencia}}</td>
                      <td class=" text-center">
                        <img (click)="CrearPdf(item)" src="assets/icons/pdf2.png" title="Descargar Pdf" alt=""
                          style="cursor: pointer;height:20px;width: 17px;" />
                      </td>
                    </tr>
                  </tbody>
                  <tbody [hidden]="noEncontroRespuesta">
                    <tr>
                      <td class="text-center" colspan="13">No se encontró coincidencias</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
        </div>
      </div>
    </div>
    <section class="row pt-2">
      <article class="row justify-content-between" style="margin: 0 auto; width: 100%; padding-bottom: 100px">
        <div class="col-md-5 table-responsive" style="padding: 5px 0px 0px 0px;  color: #a0a1cc !important;">
          <!-- d-flex justify-content-between  -->
          <!-- table-responsive -->
          <button (click)="exportListToExcel()" class="btn  form-control  buttonSinBorder colorButton"><i
              class="fas fa-download"></i> Descargar Resultados
            <!-- a Demanda Excel --></button><!-- btn-outline-info -->
        </div>
      </article>
    </section>
  </section>
</main>

<app-footer></app-footer>
