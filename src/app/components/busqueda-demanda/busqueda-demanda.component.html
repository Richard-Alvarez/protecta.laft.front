<header>
    <div > 
        <app-navbar></app-navbar> 
    </div>
    
</header>

<main  class="containerNew app-main">
    <section class="" >
        <section class="header">
            <article class="row">
                <button class="btn btn-link text-secondary" style="padding-left: 0px;" routerLink="/home" title="Regresar a la Pantalla Principal">
                    <span class="fas fa-chevron-left"></span> Pantalla Principal
                </button>
            </article>
            <article>
                <div class="row" style="display: flex;justify-content: flex-start;align-items: center;">
                    <div class="col-lg-30">
                        <h4 class="TitleLine">Búsqueda de Coincidencias a Demanda</h4>
                    </div>
                </div>
            </article>
        </section>
        <section class="row borderFormat" >
            <article class="tab-content" style="margin: 0 auto;width: 100%;">
                <div class="table-responsive" >
                    <table class=" table-striped table-sm">
                        <thead>
                            <tr>
                                <th scope="col" >
                                    <span class="fontText" >Tipo de búsqueda:</span>
                                </th>
                                <th scope="col" width="125px">
                                    <select class="form-control" (change)="searchTypeChange($event)" [(ngModel)]="NBUSCAR_POR" >
                                        <option value="1">Individual</option>
                                        <option value="2">Masiva</option>
                                    </select>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <span class="fontText" >Tipo doc:</span>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" width="135px">
                                    <select id="tipoDoc" class="form-control" [(ngModel)]="NOMBRE_RAZON">
                                        <option class="opti" value="0" title="SELCCIONAR">Seleccione</option>
                                        <option class="opti" value="2" title="dni">DNI</option>
                                        <option class="opti" value="1" title="ruc">RUC</option>
                                        <option class="opti" value="3" title="ce">CE</option>
                                        <option class="opti" value="4" title="pass">PASS</option>
                                    </select>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <span class="fontText" >Número doc:</span> 
                                </th>
                                <th [hidden]="hideIndividual"  scope="col">
                                    <input id="doc" class="form-control" type="text"  placeholder="Documento" maxlength="{{validationCantidadCaracteres()}}" size="20"
                                            (keypress)="validaNumericos($event)"[(ngModel)]="numeroDoc" [disabled]="this.NOMBRE_RAZON == 0"><!-- style="text-transform: uppercase;" -->
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <span class="fontText" >Nombre completo:</span> 
                                </th>
                                <th [hidden]="hideIndividual"  scope="col" >
                                    <input class="form-control" type="text"  placeholder="Nombre completo" maxlength="100" size="30"
                                            [(ngModel)]="nombreCompleto" (keypress)="soloLetras($event)" pattern="[a-zA-Z]+ [a-zA-Z]+ [a-zA-Z]+" ><!--(keydown)="Buscar($event)"--><!-- style="text-transform: uppercase;" -->
                                </th>
                                <th [hidden]="hideIndividual">
                                    <div type="button" data-toggle="tooltip" data-placement="top" title="[Apellido1] [Apellido2] [Nombre]">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-info" viewBox="0 0 16 16" style="border: 1px solid #A6A6A6; border-radius: 50px">
                                        <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
                                        </svg>
                                    </div>
                                </th>
                                <th [hidden]="hideIndividual" *ngIf="mostrarBotonBuscarIndividual()"  scope="col">
                                    <button id="enter" class="btn btn-warning btnBuscarStyle" (click)="validarNulos()" >Buscar</button>
                                </th>
                                <th [hidden]="hideMasiva"  scope="col">
                                    <!-- <input type="file" accept=".xlsx" onclick="this.value=null;"
                                            (change)="setDataFile($event)" [(ngModel)]="archivoExcel"
                                            style="font-size: 14px !important;" (filesChange)="lastFileAt=getDate()"> -->
                                    <div class="custom-file">
                                        <input type="file" class="custom-file-input" id="customFile" name="filename" accept=".xlsx" onclick="this.value=null;"
                                            value="seleccionar" (change)="setDataFile($event)" [(ngModel)]="archivoExcel">
                                        <label class="custom-file-label" for="customFile"
                                            style="background-color:#e9ecef">{{this.NombreArchivo == '' ? "Adjuntar Archivo" : this.NombreArchivo }}</label>
                                    </div>
                                </th>
                                <th [hidden]="hideMasiva" *ngIf="mostrarBotonBuscarMasiva()"  scope="col">
                                    <button class="btn btn-warning btnBuscarStyle" (click)="validarNulos()">Buscar</button>
                                </th>
                                <th [hidden]="hideMasiva" *ngIf="mostrarBotonBuscarMasiva()" scope="col" style="align-items: center;">
                                    <!-- <i class="fas fa-file-excel fa-3x" style="color: rgb(10, 117, 76); font-size: 35px;" (click)="DescargarPlantilla()"></i> -->
                                    <button  (click)="DescargarPlantilla()" class="btn btn-outline-info form-control ml-2 mr-2 buttonSinBorder colorButton"><i class="fas fa-download"></i> Descargar Plantilla </button>
                                </th>
                                <!-- <th [hidden]="hideMasiva" *ngIf="mostrarBotonBuscarMasiva()" scope="col" style="align-items: center;">
                                    <span class="fontText" style="color: #555555;" (click)="DescargarPlantilla()">Plantila</span>
                                </th> -->
                            </tr>
                        </thead>
                    </table>
                </div>
            </article>
            <article id="cont" class="row pt-3" style="margin: 0 auto; width: 100%;">
                <div class="table-responsive" >
                    <table class="table table-striped table-sm" style="font-size: 12px;">
                        <thead >
                            <tr style="color: rgba(38, 41, 109, 0.6);font-family: 'Roboto', sans-serif; ">
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1);">Fecha y Hora de Búsqueda</th>
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1);">Usuario que Realizó la Búsqueda</th>
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1);">Tipo Y Número de Documento</th>
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1);">Término</th>
                                <th  scope="col" style="vertical-align: middle; text-align: left;border-bottom: 2px solid rgba(38, 41, 109, 1);">Nombre/Razón Social</th>
                                <!-- <th scope="col" style="vertical-align: middle;">Tipo de Persona</th> -->
                                <!-- <th scope="col" style="vertical-align: middle;">Cargo</th> -->
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1)">% Coincidencia</th>
                                <th  scope="col" style="vertical-align: middle; text-align: left;border-bottom: 2px solid rgba(38, 41, 109, 1)">Lista</th>
                                <th  scope="col" style="vertical-align: middle; text-align: left;border-bottom: 2px solid rgba(38, 41, 109, 1)">Fuente</th>
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1)">Tipo de Coincidencia</th>
                                <th  scope="col" style="vertical-align: middle;border-bottom: 2px solid rgba(38, 41, 109, 1)" >Descargar</th>
                            </tr>
                        </thead>
                        <tbody [hidden]="false">
                            <tr *ngFor="let item of resultadoFinal; let i = index;">
                                <td  scope="col">{{item.DFECHA_BUSQUEDA}}</td>
                                <td  scope="col">{{item.SUSUARIO_BUSQUEDA != '' ? item.SUSUARIO_BUSQUEDA : '-'}} </td>
                                <td  scope="col">{{item.STIPO_DOCUMENTO}} {{item.SNUM_DOCUMENTO}}</td>
                                <td  scope="col"><div placement='top' ngbTooltip="{{item.SNOMBRE_TERMINO}}" *ngIf="item.SPROVEEDOR == 'WC'">{{cortarCararterNombre(item.SNOMBRE_TERMINO)}}</div></td>
                                <td  scope="col"><div placement='top' ngbTooltip="{{item.SNOMBRE_COMPLETO}}">{{cortarCararterNombre(item.SNOMBRE_COMPLETO)}}</div></td>
                                <!-- <td>{{item.STIPO_PERSONA}}</td>
                                <td ><div placement='top' ngbTooltip="{{item.SCARGO}}">{{item.SCARGO ? cortarCararter(item.SCARGO) : '-'}}</div></td> -->
                                <td  scope="col" style="text-align: center;">{{item.SPORCEN_COINCIDENCIA}}</td>
                                <td  scope="col">{{item.SLISTA}}</td>
                                <td  scope="col">{{item.SPROVEEDOR}}</td>
                                <td  scope="col">{{item.STIPOCOINCIDENCIA}}</td>
                                <td class=" text-center" scope="col" >
                                    <!-- <img  (click)="exportListToExcelIndividual(i)" src="assets/icons/edit.png" title="Descargar Excel" alt="" style="cursor: pointer;height:20px;width: 17px;"/> -->
                                    <!-- <img  (click)="convertirPdf(item)" src="assets/icons/pdf2.png" title="Descargar Pdf" alt="" style="cursor: pointer;height:20px;width: 17px;"/> -->
                                    <img  (click)="CrearPdf(item)" src="assets/icons/pdf2.png" title="Descargar Pdf" alt="" style="cursor: pointer;height:20px;width: 17px;"/>
                                </td>
                            </tr>
                        </tbody>
                        <tbody [hidden]="noEncontroRespuesta">
                            <tr>
                                <td class="text-center" colspan="10">No se encontró coincidencias</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </article>

            
        </section>
        <section class="row pt-2" >
            <article class="row justify-content-between" style="margin: 0 auto; width: 100%; padding-bottom: 100px" >
                <div class="col-md-5 table-responsive" style="padding: 5px 0px 0px 0px;  color: #a0a1cc !important;"> <!-- d-flex justify-content-between  --> <!-- table-responsive -->
                    <button (click)="exportListToExcel()" class="btn  form-control  buttonSinBorder colorButton"><i class="fas fa-download"></i> Descargar Resultados a Demanda Excel</button><!-- btn-outline-info -->
                </div>
                <!-- <div class="col-md-5 table-responsive" style="padding: 5px 30px 0px 0px;  color: #a0a1cc !important;"> 
                    <button (click)="convertirPdf()" class="btn  form-control  buttonSinBorder colorButton"><i class="fas fa-download"></i> Descargar Resultados a Demanda en PDF </button>
                </div> -->
                <!-- <div class="col-md-5 table-responsive" style="padding: 5px 0px 0px 0px;  color: #a0a1cc !important;"> 
                    <button (click)="CrearPdf()" class="btn  form-control  buttonSinBorder colorButton"><i class="fas fa-download"></i>PDF</button>
                </div> -->
             </article>
              
        </section>
    </section>
</main>

<app-footer></app-footer>