<header>
    <div > 
        <app-navbar></app-navbar> 
    </div>
    
</header>
<main class="container app-main">
    <section class="container" >
        <section class="header">
            <article class="row">
                <button class="btn btn-link text-secondary" style="padding-left: 0px;" routerLink="/home" title="Regresar a la Pantalla Principal">
                    <span class="fas fa-chevron-left"></span> Pantalla Principal
                </button>
            </article>
            <article>
                <div class="row" style="display: flex;justify-content: flex-start;align-items: center;">
                    <div class="col-lg-30">
                        <h4 class="TitleLine">Búsqueda de coincidencias a demanda</h4>
                    </div>
                </div>
            </article>
        </section>
        <section class="row borderFormat" >
            <article class="tab-content" style="margin: 0 auto;width: 100%;">
                <div class="table-responsive" >
                    <table class=" table-striped table-sm">
                        <thead>
                            <tr>
                                <th scope="col" >
                                    <span class="fontText" >Busqueda:</span>
                                </th>
                                <th scope="col">
                                    <select class="form-control" (change)="searchTypeChange($event)" [(ngModel)]="NBUSCAR_POR" >
                                        <option value="1">Individual</option>
                                        <option value="2">Masiva</option>
                                    </select>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <span class="fontText" >Tipo Doc:</span>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <select class="form-control" [(ngModel)]="NOMBRE_RAZON">
                                        <option value="2" title="dni">DNI</option>
                                        <option value="1" title="ruc">RUC</option>
                                        <option value="2" title="ruc">CE</option>
                                        <option value="2" title="ruc">PASS</option>
                                    </select>
                                </th>
                                <th [hidden]="hideIndividual" scope="col" >
                                    <span class="fontText" >Número Doc:</span>
                                </th>
                                <th [hidden]="hideIndividual"  scope="col">
                                    <input class="form-control" type="text" style="text-transform: uppercase;" placeholder="Número de Documento" maxlength="100" size="34"
                                            [(ngModel)]="numeroDoc" >
                                </th>
                                <th [hidden]="hideIndividual"  scope="col">
                                    <input class="form-control" type="text" style="text-transform: uppercase;" placeholder="adjunte datos de búsqueda" maxlength="100" size="34"
                                            [(ngModel)]="nombreCompleto" (keydown)="Buscar($event)">
                                </th>
                                <th [hidden]="hideIndividual" *ngIf="mostrarBotonBuscarIndividual()"  scope="col">
                                    <button id="enter" class="btn btn-warning btnBuscarStyle" (click)="BusquedaADemandaMixta()" >Buscar</button><!-- obtenerBusquedaCoincidenciaXNombreDemanda() --><!-- BusquedaADemandaMixta -->
                                </th>
                                <th [hidden]="hideMasiva"  scope="col">
                                    <input type="file" accept=".xlsx" onclick="this.value=null;"
                                            (change)="setDataFile($event)" [(ngModel)]="archivoExcel"
                                            style="font-size: 14px !important;" (filesChange)="lastFileAt=getDate()">
                                </th>
                                <th [hidden]="hideMasiva" *ngIf="mostrarBotonBuscarMasiva()"  scope="col">
                                    <button class="btn btn-warning btnBuscarStyle" (click)="obtenerBusquedaCoincidenciaXNombreDemanda()">Buscar</button><!-- obtenerBusquedaCoincidenciaXNombreDemanda() --><!-- BusquedaADemandaMixta -->
                                </th>
                            </tr>
                        </thead>
                    </table>
                </div>
            </article>
            <article class="row" style="margin: 0 auto; width: 100%;">
                <div class="table-responsive" >
                    <table class="table table-striped table-sm" style="font-size: 12px;">
                        <thead >
                            <tr style="color: rgba(38, 41, 109, 0.6);font-family: 'Roboto', sans-serif; ">
                                <th  scope="col" style="vertical-align: middle;">Fecha y Hora de Búsqueda</th>
                                <th  scope="col" style="vertical-align: middle;">Usuario que Realizó la Busqueda</th>
                                <th  scope="col" style="vertical-align: middle;">Tipo de Documento</th>
                                <th  scope="col" style="vertical-align: middle;">Número de Documento</th>
                                <th  scope="col" style="vertical-align: middle; text-align: left;">Nombre/Razón Social</th>
                                <!-- <th scope="col" style="vertical-align: middle;">Tipo de Persona</th> -->
                                <!-- <th scope="col" style="vertical-align: middle;">Cargo</th> -->
                                <th  scope="col" style="vertical-align: middle;">% Coincidencia</th>
                                <th  scope="col" style="vertical-align: middle; text-align: left;margin-right: 20px;">Lista</th>
                                <th  scope="col" style="vertical-align: middle;">Descargar</th>
                            </tr>
                        </thead>
                        <tbody [hidden]="encontroRespuesta">
                            <tr *ngFor="let item of resultadoFinal; let i = index;">
                                <td  scope="col">{{item.DFECHA_BUSQUEDA}}</td>
                                <td  scope="col">{{item.SUSUARIO_BUSQUEDA ? item.SUSUARIO_BUSQUEDA : '-'}}</td>
                                <td  scope="col">{{item.STIPO_DOCUMENTO}}</td>
                                <td  scope="col">{{item.SNUM_DOCUMENTO}}</td>
                                <td  scope="col"><div placement='top' ngbTooltip="{{item.SNOMBRE_COMPLETO}}">{{cortarCararterNombre(item.SNOMBRE_COMPLETO)}}</div></td>
                                <!-- <td>{{item.STIPO_PERSONA}}</td>
                                <td ><div placement='top' ngbTooltip="{{item.SCARGO}}">{{item.SCARGO ? cortarCararter(item.SCARGO) : '-'}}</div></td> -->
                                <td  scope="col" style="text-align: right;">{{item.SPORCEN_COINCIDENCIA}}</td>
                                <td  scope="col">{{item.SLISTA}}</td>
                                <td class=" text-center" scope="col">
                                    <img  (click)="exportListToExcelIndividual(i)" src="assets/icons/edit.png" title="Descargar Excel" alt="" style="cursor: pointer;height:20px;width: 17px;"/>
                                </td>
                            </tr>
                        </tbody>
                        <tbody [hidden]="noEncontroRespuesta">
                            <tr>
                                <td class="text-center" colspan="8">No se encontró coincidencias</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </article>
        </section>
        <section>
            <div class="col-md-5 d-flex justify-content-between " style="padding: 5px 0px 0px 0px; margin-left: -15px; color: #a0a1cc !important;">
                <button (click)="exportListToExcel()" class="btn btn-outline-info form-control  buttonSinBorder colorButton"><i class="fas fa-download"></i> Descargar Resultados a Demanda</button>
            </div>
        </section>
    </section>
</main>

<app-footer></app-footer>